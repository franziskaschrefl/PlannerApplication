
@inject DataTransferObject DTObject
@rendermode InteractiveServer
@using PlannerCSharp.DataAccessLayer


<div class="mood-tracker">
    <div class="header-mood">
        <p>Mood Tracker</p>
    </div>
    <div class="buttons-mood">
        <div class="mood-row">
            <input type="radio" class="btn-check" name="options" id="mood1" autocomplete="off">
            <label class="btn btn-success mood" for="mood1"><i class="bi bi-emoji-grin"></i></label>

            <input type="radio" class="btn-check" name="options" id="mood2" autocomplete="off">
            <label class="btn btn-info mood" for="mood2"><i class="bi bi-emoji-smile"></i></label>

            <input type="radio" class="btn-check" name="options" id="mood3" autocomplete="off">
            <label class="btn btn-primary mood" for="mood3"><i class="bi bi-emoji-tear"></i></label>
        </div>
        <div class="mood-row">
            <input type="radio" class="btn-check" name="options" id="mood4" autocomplete="off">
            <label class="btn btn-warning mood" for="mood4"><i class="bi bi-emoji-grimace"></i></label>

            <input type="radio" class="btn-check" name="options" id="mood5" autocomplete="off">
            <label class="btn btn-danger mood" for="mood5"><i class="bi bi-emoji-angry"></i></label>
        </div>
    </div>
    
    

    
</div>

@code {
    private string mood = "";
    public void Reload()
    {


        DatabaseRequest request = new DatabaseRequest($"SELECT * FROM Mood_Tracker WHERE username = '{Environment.UserName}' AND date = '{DTObject.SelectedDate.ToString("yyyy-MM-dd")}'; ");
        getValues(request.PerformQuery());
        StateHasChanged();
    }

    void getValues(DatabaseResponse response)
    {
        if (response == null)
        {
            return;
        }
        if (response.Rows == 1)
        {
            mood = response["mood"][0];
        }
    }



    protected override void OnAfterRender(bool firstRender)
    {
        if (firstRender)
        {
            Reload();
            DTObject.OnDateChange += Reload;
        }


    }
    
}
